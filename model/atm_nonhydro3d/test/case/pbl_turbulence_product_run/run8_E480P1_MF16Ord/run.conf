#--- Configuration file for a test case of idealized planetary boundary layer turbulence -------
&PARAM_RESTART
  IN_BASENAME = "../run7_E480P1_MF16Ord/restart_00000101-033000.000",
  OUTPUT_FLAG = .true., 
  OUT_BASENAME = "restart"
/
&PARAM_TIME
  TIME_STARTDATE       = 0000, 1, 1, 3, 30, 0,
  TIME_STARTMS         = 0.D0,
  TIME_DURATION        = 1800D0, 
  TIME_DURATION_UNIT   = "SEC",  
  TIME_DT              = 0.0125D0, 
  TIME_DT_UNIT         = "SEC", 
/
&PARAM_USER
  USER_do = .true., 
/
#** ATMOS ******************************************************
&PARAM_ATMOS
  ACTIVATE_FLAG = .true., 
  TIME_DT       = 0.0125D0, 
  TIME_DT_UNIT  = SEC, 
  TIME_DT_RESTART = 900D0, 
  TIME_DT_RESTART_UNIT="SEC",    
  ATMOS_DYN_DO    = .true.,
  ATMOS_PHY_SF_DO = .true.,
  ATMOS_PHY_TB_DO = .true.,
/
&PARAM_ATMOS_MESH
  dom_xmin         =   0.0D3,  
  dom_xmax         =   9.6D3, 
  isPeriodicX      = .true.,
  dom_ymin         =   0.0D3,  
  dom_ymax         =   9.6D3,  
  isPeriodicY      = .true., 
  dom_zmin         =   0.0D0,  
  dom_zmax         =   3.0D3, 
  NprcX            = 40, 
  NeX              = 12, 
  NprcY            = 40, 
  NeY              = 12,
  NeZ              = 120,
  Fz               = 0D0, 20.0D0, 40.0D0, 60.0D0, 80.0D0, 100.0D0, 120.0D0, 140.0D0, 160.0D0, 180.0D0, 200.0D0, 220.0D0, 240.0D0, 260.0D0, 280.0D0, 300.0D0, 320.0D0, 340.0D0, 360.0D0, 380.0D0, 400.0D0, 420.0D0, 440.0D0, 460.0D0, 480.0D0, 500.0D0, 520.0D0, 540.0D0, 560.0D0, 580.0D0, 600.0D0, 620.0D0, 640.0D0, 660.0D0, 680.0D0, 700.0D0, 720.0D0, 740.0D0, 760.0D0, 780.0D0, 800.0D0, 820.0D0, 840.0D0, 860.0D0, 880.0D0, 900.0D0, 920.0D0, 940.0D0, 960.0D0, 980.0D0, 1000.0D0, 1020.0D0, 1040.0D0, 1060.0D0, 1080.0D0, 1100.0D0, 1120.0D0, 1140.0D0, 1160.0D0, 1180.0D0, 1200.0D0, 1220.0D0, 1240.0D0, 1260.0D0, 1280.0D0, 1300.0D0, 1320.0D0, 1340.0D0, 1360.0D0, 1380.0D0, 1400.0D0, 1420.0D0, 1440.0D0, 1460.0D0, 1480.0D0, 1500.0D0, 1520.0D0, 1540.0D0, 1560.0D0, 1580.0D0, 1600.0D0, 1620.0D0, 1640.0D0, 1660.0D0, 1680.0D0, 1700.0D0, 1720.0D0, 1740.0D0, 1760.0D0, 1780.0D0, 1800.0D0, 1820.0D0, 1840.0D0, 1860.0D0, 1880.0D0, 1900.0D0, 1920.0D0, 1940.0D0, 1960.0D0, 1981.387343D0, 2004.25826503D0, 2028.71567774D0, 2054.86963146D0, 2082.83781042D0, 2112.74606224D0, 2144.72896425D0, 2178.93042903D0, 2215.50435194D0, 2254.61530364D0, 2296.4392706D0, 2341.16444695D0, 2388.99208132D0, 2440.13738237D0, 2494.83048719D0, 2553.31749682D0, 2615.86158362D0, 2682.74417548D0, 2754.26622211D0, 2830.74954928D0, 2912.53830687D0, 3000D0, 
  PolyOrder_h      = 1,
  PolyOrder_v      = 1,
!  LUMPEDMASSMATFLAG = .true., 
/
&PARAM_ATMOS_VARS
  CHECK_RANGE = .true. ,
  CHECK_TOTAL = .false.,
/
#** ATMOS / DYN ******************************************************
&PARAM_ATMOS_DYN
  EQS_TYPE         = "NONHYDRO3D_HEVE", 
  !-
  TINTEG_TYPE      = "ERK_SSP_10s4o_2N",
  TIME_DT          = 0.0125D0, 
  TIME_DT_UNIT     = SEC, 
  !-
  MODALFILTER_FLAG  = .true.,
  NUMDIFF_FLAG      = .false.,
  SPONGELAYER_FLAG  = .true., 
/
&PARAM_ATMOS_DYN_BND
  btm_vel_bc   = "SLIP", 
  top_vel_bc   = "SLIP", 
  north_vel_bc = "PERIODIC", 
  south_vel_bc = "PERIODIC", 
  east_vel_bc  = "PERIODIC", 
  west_vel_bc  = "PERIODIC", 
  btm_thermal_bc   = "ADIABATIC", 
  top_thermal_bc   = "ADIABATIC", 
  north_thermal_bc = "PERIODIC", 
  south_thermal_bc = "PERIODIC", 
  west_thermal_bc  = "PERIODIC", 
  east_thermal_bc  = "PERIODIC", 
/
&PARAM_ATMOS_DYN_MODALFILTER
  MF_ETAC_h  = 0.0D0, 
  MF_ALPHA_h = 1D-3, 
  MF_ORDER_h = 16,
  MF_ETAC_v  = 0.0D0, 
  MF_ALPHA_v = 1D-3, 
  MF_ORDER_v = 16,
/
&PARAM_ATMOS_DYN_SPONGELAYER
  SL_WDAMP_TAU     = 10D0, 
  SL_WDAMP_HEIGHT  = 2000D0,  
/
&PARAM_ATMOS_DYN_DGM_NONHYDRO3D_HEVE_NUMFLUX
  NUMFLX_STAB_CsFact      = 0.0D0, 
  NUMFLX_STAB_VelFact     = 1.0D0, 
  NUMFLX_STAB_CsFact_MOM  = 0.0D0, 
  NUMFLX_STAB_VelFact_MOM = 1.0D0, 
/
#** ATMOS / PHYS / SFC ******************************************************
&PARAM_ATMOS_PHY_SFC
  TIME_DT       = 0.0125D0, 
  TIME_DT_UNIT  = "SEC", 
  SFCFLX_TYPE   = "CONST",
/
&PARAM_ATMOS_PHY_SF_CONST
 ATMOS_PHY_SF_Const_SH =   200.D0,
 ATMOS_PHY_SF_Const_LH =     0.D0,
 ATMOS_PHY_SF_Const_Cm = 0.0011D0,
/
#** ATMOS / PHYS / Turbulence ***********************************************
&PARAM_ATMOS_PHY_TB
  TIME_DT      = 0.0125D0, 
  TIME_DT_UNIT = "SEC", 
  TB_TYPE      = "SMAGORINSKY", 
/
#*** OUTPUT *******************************************
&PARAM_FILE_HISTORY
 FILE_HISTORY_DEFAULT_BASENAME  = "history",
 FILE_HISTORY_DEFAULT_TINTERVAL = 60.0D0, 
 FILE_HISTORY_DEFAULT_TUNIT     = "SEC",
 FILE_HISTORY_DEFAULT_TAVERAGE  = .false.,
 FILE_HISTORY_DEFAULT_DATATYPE  = "REAL4",
 FILE_HISTORY_OUTPUT_STEP0      = .true.,
/
&HISTORY_ITEM name=DDENS        /
&HISTORY_ITEM name=U            /
&HISTORY_ITEM name=V            /
&HISTORY_ITEM name=W            /
&HISTORY_ITEM name=PT           /
!&HISTORY_ITEM name=T           /
!&HISTORY_ITEM name=NU           /
!&HISTORY_ITEM name=KH           /
!&HISTORY_ITEM name=DENS_hyd     /
!&HISTORY_ITEM name=PRES_hyd     /
!&HISTORY_ITEM name=MOMX_tp      /
!&HISTORY_ITEM name=MOMY_tp      /
!&HISTORY_ITEM name=MOMZ_tp      /
!&HISTORY_ITEM name=RHOT_tp      /

#*** Statistics *******************************************

&PARAM_MESHFIELD_STATISTICS
 use_globalcomm = .true.,
/
&PARAM_MONITOR 
  MONITOR_STEP_INTERVAL = 800 
/
&MONITOR_ITEM name=DDENS /
&MONITOR_ITEM name=ENGT  /
&MONITOR_ITEM name=ENGK  /
&MONITOR_ITEM name=ENGI  /
&MONITOR_ITEM name=ENGP  /
